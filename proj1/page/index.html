<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CS180 Project 1: Image Alignment</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; background: #f9f9f9; }
        h1, h2 { color: #333; }
        .gallery { display: flex; flex-wrap: wrap; gap: 2em; }
        .img-card { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 1em; width: 320px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);}
        .img-card img { max-width: 100%; border-radius: 4px; }
        .filename { font-size: 1em; color: #555; margin-top: 0.5em; }
    </style>
</head>
<body>
    <h1>CS180 Project 1: Image Alignment</h1>
    <section>
        <h2>Overview</h2>
        <p>
            In this project, I implemented an algorithm to align images taken by the 
            late Russian photographer Sergei Mikhailovich Prokudin-Gorskii. Each scene
            was recorded as three separate black-and-white photographs using red, green, and blue
            filters. In order to colorize the images, I needed to align the three channels
            correctly. I used normalized cross-correlation (NCC) as my metric
            to find the best alignment by searching over a window of possible displacements.
            The final results are shown in the gallery below, along with the computed displacements
            for the red and green channels relative to the blue channel.
        </p>
    </section>
       <section>
        <h2>Methodology</h2>
        <p>
            First, I split each input image into its three color channels and try to align the
            red and green channels to the blue channel. After aligning the images, they're then stacked
            together to form the final color image.
        </p>
        <p>
            For the simple jpg files, I just do an exhaustive search over a window of possible
            displacements (from -15 to +15 pixels in both x and y directions). By default, I also have a 
            local average normalization step to reduce the effect of lighting variations. Essentially, the image
            is blurred with a box filter and then each pixel is divided by the local average.
        </p>
        <p>
            For the larger tiff files, I implemented a Gaussian pyramid approach to speed up the alignment.
            The image is repeatedly downsampled by a factor of 2 until the smallest dimension is less than 100 pixels.
            Then, I perform the exhaustive search on the smallest image with a small search window (from -15 to +15 pixels).
            The resulting displacement is then scaled up by a factor of 2 and used as the center of a new search window
            but for for a window of -5 to +5 pixels on the next larger image. This process is repeated until reaching the original image size.
            This approach significantly reduces the number of NCC computations needed, speeding up the alignment for large images.
        </p>    
        <p>
            Below are the final results of the alignment along with the computed displacements. Enjoy!
    </section> 
    <section>
        <h2>Gallery</h2>
        <div class="gallery">
            <div class="gallery">
                <div class="img-card">
                    <img src="media/cathedral.jpg" alt="cathedral.jpg">
                    <div class="filename">cathedral.jpg</div>
                    <div class="displacement">
                        R: (10, 3)<br>
                        G: (5, 2)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/church.jpg" alt="church.jpg">
                    <div class="filename">church.jpg</div>
                    <div class="displacement">
                        R: (59, -4)<br>
                        G: (25, 4)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/emir.jpg" alt="emir.jpg">
                    <div class="filename">emir.jpg</div>
                    <div class="displacement">
                        R: (105, 42)<br>
                        G: (50, 23)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/harvesters.jpg" alt="harvesters.jpg">
                    <div class="filename">harvesters.jpg</div>
                    <div class="displacement">
                        R: (123, 13)<br>
                        G: (59, 17)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/icon.jpg" alt="icon.jpg">
                    <div class="filename">icon.jpg</div>
                    <div class="displacement">
                        R: (89, 23)<br>
                        G: (40, 18)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/italil.jpg" alt="italil.jpg">
                    <div class="filename">italil.jpg</div>
                    <div class="displacement">
                        R: (77, 35)<br>
                        G: (38, 21)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/lastochikino.jpg" alt="lastochikino.jpg">
                    <div class="filename">lastochikino.jpg</div>
                    <div class="displacement">
                        R: (76, -9)<br>
                        G: (-3, -2)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/lugano.jpg" alt="lugano.jpg">
                    <div class="filename">lugano.jpg</div>
                    <div class="displacement">
                        R: (93, -29)<br>
                        G: (41, -16)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/melons.jpg" alt="melons.jpg">
                    <div class="filename">melons.jpg</div>
                    <div class="displacement">
                        R: (180, 12)<br>
                        G: (85, 11)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/monastery.jpg" alt="monastery.jpg">
                    <div class="filename">monastery.jpg</div>
                    <div class="displacement">
                        R: (3, 2)<br>
                        G: (-3, 2)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/self_portrait.jpg" alt="self_portrait.jpg">
                    <div class="filename">self_portrait.jpg</div>
                    <div class="displacement">
                        R: (179, 38)<br>
                        G: (81, 30)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/siren.jpg" alt="siren.jpg">
                    <div class="filename">siren.jpg</div>
                    <div class="displacement">
                        R: (96, -25)<br>
                        G: (50, -6)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/three_generations.jpg" alt="three_generations.jpg">
                    <div class="filename">three_generations.jpg</div>
                    <div class="displacement">
                        R: (113, 10)<br>
                        G: (55, 14)
                    </div>
                </div>
                <div class="img-card">
                    <img src="media/tobolsk.jpg" alt="tobolsk.jpg">
                    <div class="filename">tobolsk.jpg</div>
                    <div class="displacement">
                        R: (7, 3)<br>
                        G: (3, 3)
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>
</html>